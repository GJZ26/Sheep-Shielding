var r=Object.defineProperty;var u=(s,t,a)=>t in s?r(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var i=(s,t,a)=>u(s,typeof t!="symbol"?t+"":t,a);(function(){"use strict";class s{constructor(){i(this,"_initialAnimalCount",5);i(this,"_initialEnemyCount",1);i(this,"_currentAnimalAlive",0);i(this,"_incrementEnemyByRound",1.3);i(this,"_incrementAnimalByRound",.2);i(this,"_cowSpawnRelation",.2);i(this,"_rabidWolfSpawnRelation",.2);i(this,"_timesDeath",0);i(this,"_roundCount",1);i(this,"_sheepSaved",0);i(this,"_sheepKilled",0);i(this,"_wolfKilled",0);i(this,"_startPlayAt",Date.now());i(this,"_started",!1);i(this,"_status","in-progress");console.info("üïπÔ∏è Creating a new game")}set ready(e){this._started=e}get round(){return this._roundCount}invokeCurrentEnemies(e){const n=[],l=Math.round((Math.round(this._initialAnimalCount)-this._currentAnimalAlive)*this._cowSpawnRelation),o=Math.round(Math.round(this._initialEnemyCount)*this._rabidWolfSpawnRelation);return n.push({type:"sheep",amount:Math.round(this._initialAnimalCount)-this._currentAnimalAlive-l,clearQueue:e}),n.push({type:"wolf",amount:Math.round(this._initialEnemyCount)-o,clearQueue:e}),n.push({type:"cow",amount:l,clearQueue:!1}),n.push({type:"rabidWolf",amount:o,clearQueue:!1}),n}updateMatchStatus(e){return this._status==="lost"||!this._started?!1:(e.isPlayerAlive||this._timesDeath++,e.animalsAlive<=0?(this._status="lost",this._sheepKilled+=this._initialAnimalCount-this._currentAnimalAlive,this._wolfKilled+=Math.round(this._initialEnemyCount)-e.enemiesAlive,!0):e.enemiesAlive<=0?(this._roundCount++,this._sheepKilled+=this._initialAnimalCount-this._currentAnimalAlive,this._sheepSaved+=e.animalsAlive,this._wolfKilled+=Math.round(this._initialEnemyCount),this._currentAnimalAlive=e.animalsAlive,this._initialEnemyCount+=this._incrementEnemyByRound,this._initialAnimalCount+=this._incrementAnimalByRound,!0):!1)}get isLost(){return this._status==="lost"}get resume(){const e=(Date.now()-this._startPlayAt)/1e3;return{rounds:this._roundCount,timesDeath:this._timesDeath,sheepKilled:this._sheepKilled,sheepSaved:this._sheepSaved,wolfKilled:this._wolfKilled,timePlayingInSecond:e,score:this._roundCount*1e3+this._sheepSaved*200+this._wolfKilled*100+Math.round(e)}}}console.info("‚öôÔ∏è Game Manager Up");const t=new s;self.onmessage=a=>{const{type:e,params:n}=a.data;e==="invoke"&&self.postMessage({type:"round",params:[t.invokeCurrentEnemies(n[0]),t.round]}),e==="update"&&t.updateMatchStatus(n[0])&&(t.isLost?self.postMessage({type:"lost",params:[t.resume]}):self.postMessage({type:"round",params:[t.invokeCurrentEnemies(!1),t.round]})),e==="ready"&&(t.ready=!0)}})();
